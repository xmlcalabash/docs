<!DOCTYPE html><html xmlns="http://www.w3.org/1999/xhtml" class="no-js"><head><meta http-equiv="Content-Type" content="text/html; charset=utf-8"/><script>(function(H){H.className=H.className.replace(/\bno-js\b/,'js')})(document.documentElement)</script><title>Appendix C. Change log</title><link href="./css/pygments.css" rel="stylesheet"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><link href="https://purl.org/dc/elements/1.1/" rel="schema.dc"/><meta name="dc.modified" content="2025-01-01T18:37:53Z"/><meta name="generator" content="DocBook xslTNG version 2.5.0 / 855db8f2 / SAXON HE 12.5"/><link href="./css/docbook-toc.css" rel="stylesheet"/><link href="./css/docbook.css" rel="stylesheet" media="screen"/><link href="img/icon.png" rel="shortcut icon"/><link href="./css/xmlcalabash.css" rel="stylesheet"/><link href="./css/xproc.css" rel="stylesheet"/><link rel="prev" href="tracing.html"/><link rel="up" href="index.html"/><link rel="home" href="index.html"/><script src="./js/persistent-toc.js" defer="defer"></script><script src="./js/chunk-nav.js" defer="defer"></script></head><body class="appendix component"><nav class="top"><div><a href="index.html">Home</a> <a href="index.html">Up</a>  <a href="tracing.html">Prev</a></div></nav><main><section id="changelog" db-chunk="changelog.html" db-id="d111e2583" class="appendix component"><header><h2>Appendix <span class="label">C</span><span class="sep">. </span>Change log</h2></header><p>This section documents the significant changes made in each release.
See the commits and pull requests on
<a href="https://github.com/xmlcalabash/xmlcalabash3/" class="link">the repository</a> for
finer detail.</p><div class="revhistory"><header><div class="title">Revision History</div></header><ul><li id="r300-alpha9" class="revision"><div class="revnumber"><span class="revnumber">3.0.0-alpha9</span>, <span class="date" time="2025-01-01">01 Jan 2025</span></div><div class="description"><div class="revdescription">
<ul class="itemizedlist"><li><p>Fixed
<a href="https://github.com/xmlcalabash/xmlcalabash3/issues/92" class="link">issue #92</a>.
Updated the <code class="tag tag-element">p:archive</code>, <code class="tag tag-element">p:archive-manifest</code>,
and <code class="tag tag-element">p:unarchive</code> steps to support all of the formats
supported by the Apache Commons Compression library. The “create”
command on <code class="tag tag-element">p:archive</code> also supports merging multiple archives together.
</p></li><li><p>Added a “visualization” API for tracking pipeline progress.
Extensively revised how <a href="logging.html" class="link">logging</a> works.
Removed the now unnecessary “progress” level of verbosity.</p><p>By default system logging only goes to the console and uses dynamic
levels. For a different configuration, use a different <a href="logging.html#logback-file" class="link">logback.xml
configuration</a> file.</p></li><li><p>Fixed bugs related to <code>[p:]message</code> attributes.
Messages are now output through the message reporter at “info” level,
rather than being printed directly to the console. Fixed a bug where static
messages on compound steps were not being output at all.
</p></li><li><p>Completely reworked how XVRL is supported. There’s now an internal model for the
report format. Conversion from SVRL to XVRL is done by constructing the XVRL model.
</p></li><li><p>Fixed
<a href="https://github.com/xmlcalabash/xmlcalabash3/issues/90" class="link">issue #90</a>
by correcting a typo in the SVG graphing stylesheet.
</p></li><li><p>Fixed
<a href="https://github.com/xmlcalabash/xmlcalabash3/issues/93" class="link">issue #93</a>
by removing the accidental restriction that <code class="tag tag-element">p:variable</code> was
not allowed in <code class="tag tag-element">p:if</code>. Hat tip to Achim for reporting that
one!
</p></li><li><p>Fixed
<a href="https://github.com/xmlcalabash/xmlcalabash3/issues/96" class="link">issue #96</a>.
An option that had no default value but whose type did not allow the
empty sequence was generating a compile time error about the invalid
(default) value. The initializer now defers the error until runtime (where it
won’t happen if a value is provided for the option).
</p></li><li><p>Added <code class="literal">application/epub+zip</code>,
<code class="literal">application/java-archive</code>,
<code class="literal">application/x-7z-compressed</code>,
<code class="literal">application/x-archive</code>,
<code class="literal">application/x-arj</code>,
<code class="literal">application/x-cpio</code>, and
<code class="literal">application/x-tar</code> to the standard content type mapping.</p></li><li><p>Added an experimental <code class="command">xmlcalabash.sh</code> script to the distribution.
This should make it easier to run XML Calabash with a modified classpath.
</p></li><li><p>Renamed a few build properties. The <code>BUILD_HASH</code> is now 
<code>BUILD_ID</code> and is more sensitive to internal builds. Renamed <code>SAXON</code>
to <code>SAXON_EDITION</code> and removed the misleading <code>SAXON_LICENSED</code> property.
(If you run PE or EE without a license, the edition reported is HE.)
</p></li><li><p>Attempt to detect when PE or EE is running without a license and provide a more
helpful version message.
</p></li><li><p>Upgraded to SchXslt 1.3.1. Upgrade to jing/trang 20241231. Upgraded a few Kotlin libraries.
Added the brotli and xz libraries to the core build.
</p></li><li><p>Fixed a bug where the error location information for an error was getting lost.
</p></li></ul>
</div></div></li><li id="r300-alpha8" class="revision"><div class="revnumber"><span class="revnumber">3.0.0-alpha8</span>, <span class="date" time="2024-12-28">28 Dec 2024</span></div><div class="description"><div class="revdescription">
<ul class="itemizedlist"><li><p>Fixed an issue where the command line interface used by the debugger was
always a “dumb” terminal. It now supports history and editing keys.
</p></li><li><p>Improve the error messages associated with attempting to set inputs or
outputs on the command line for ports that don’t exist in the pipeline.
</p></li><li><p>An error is now reported if <code class="tag tag-attribute">psvi-required</code> is true but the
processor doesn’t support XML Schema validation. (Saxon EE is required for PSVI support.)
</p></li><li><p>Renamed the “<code class="literal">schema-aware</code>” command line option and configuration
property to “<code class="literal">licensed</code>”. Cleaned up the tests for schema awareness in
several places.
</p></li><li><p>Added support for the <code>[p:]timeout</code> option on steps.
</p></li><li><p>Added support for the <code class="literal">timeout</code> parameter on <code class="tag tag-element">p:http-request</code>.
</p></li><li><p>Improved the error message associated with an undeclared prefix in an XPath expression.
</p></li><li><p>Improved the error codes reported for static errors in several places.
</p></li><li><p>Reworked the <code class="interfacename">MessageReporter</code> interface;
allowed one reporter to chain to another. Added a buffering reporter to keep track
of messages. By default the buffering reporter chains to the default reporter
which chains to the logging reporter. The buffering reporter holds the last 32
messages. The default reporter prints messages to the console if they have a
level that exceeds the verbosity threshold. The logging reporter sends all
messages to the Java logger.</p><p>There’s a new <code>message-buffer-size</code>
configuration setting to set the number of messages to buffered.</p></li><li><p>Added a new <code class="tag tag-element">cx:pipeline-messages</code> extension step that can
retrieve the messages buffered by the buffering reporter.
</p></li><li><p>Changed the message reporter and document manager to be unique per-pipeline,
rather than shared across multiple pipelines.</p></li><li><p>Fixed a bug where serialization properties on <code class="tag tag-element">p:output</code> were not
being applied when pipeline outputs were serialized.</p></li><li><p>Fixed a bug where XML Calabash was failing to detect that <code class="tag tag-element">p:import</code>
must precede <code class="tag tag-element">p:input</code> and <code class="tag tag-element">p:output</code>.
Fixed that error in many of the tests in the extra test suite.</p></li><li><p>Improved support for Schematron assertions. Assertions are now applied to non-XML
values by first performing “cast content type” on them.
</p></li><li><p>Added support for a <code class="tag tag-attribute">cx:href</code> attribute on
<code class="tag tag-element">p:pipeinfo</code>. When present, the processor behaves as if the referenced
document appeared where the reference appears. The <code class="tag tag-element">p:pipeinfo</code> must be
empty and the <code class="tag tag-attribute">cx:href</code> must point to a
<code class="tag tag-element">p:pipeinfo</code> document. This makes it practical to share Schematron
assertions across pipelines.
</p></li><li><p>“<a href="running.html#upgrading-saxon" class="link">Fixed</a>”
<a href="https://github.com/xmlcalabash/xmlcalabash3/issues/74" class="link">#74</a>
by adding a hack to the manifest classpath.
</p></li><li><p>Fixed an obscure bug in the debug logging message associated with
<code class="tag tag-element">p:sleep</code>.
</p></li><li><p>Upgraded from SchXslt1 to SchXslt2 version 1.3.</p></li><li><p>Cleaned up the error reporter in many steps.
</p></li><li><p>Removed the defunct <code>debug</code> configuration setting.
</p></li><li><p>Improve the reference documentation for steps. Defer to the specification and to
Erik Siegal’s <em>excellent</em> <a href="https://XProcRef.org/" class="link">XProcRef</a>
for standard step descriptions.
</p></li></ul>
</div></div></li><li id="r300-alpha7" class="revision"><div class="revnumber"><span class="revnumber">3.0.0-alpha7</span>, <span class="date" time="2024-12-24">24 Dec 2024</span></div><div class="description"><div class="revdescription">
<ul class="itemizedlist"><li><p>Added the <a href="assertions.html" class="link">Schematron assertions feature</a>.
</p></li><li><p>Added a <code class="command"><a href="debugging.html#dbg-catch">catch</a></code> command to the
debugger to catch steps that fail. Added an option to the 
<code class="command"><a href="debugging.html#dbg-step">step</a></code> command to stop after a step executes.
</p></li><li><p>Fixed <a href="https://github.com/xproc/3.0-test-suite/pull/783" class="link">a bug</a>
in the way steps are handled in nested, common imports.</p></li><li><p>Fixed <a href="https://github.com/xproc/3.0-test-suite/pull/781" class="link">p:filter</a>
to work as expected rather than as documented. See also,
<a href="https://github.com/xproc/3.0-steps/pull/645" class="link">PR #645</a>, the documentation
fix.</p></li><li><p>Updated the <a href="tracing.html" class="link">trace listener</a> to record when steps fail.</p></li><li><p>Tinkered with the message listener to align its methods with the
<a href="#revision-verbosity" class="link">recent changes</a> to
<code class="option"><a href="running.html#cli-verbosity">--verbosity</a></code>.</p></li></ul>
</div></div></li><li id="r300-alpha6" class="revision"><div class="revnumber"><span class="revnumber">3.0.0-alpha6</span>, <span class="date" time="2024-12-23">23 Dec 2024</span></div><div class="description"><div class="revdescription">
<ul class="itemizedlist"><li><p>Added <a href="debugging.html" class="link">an interactive debugger</a>.</p></li><li><p>Added a <a href="tracing.html" class="link">tracing feature</a>.</p></li><li><p>Fixed
<a href="https://github.com/xmlcalabash/xmlcalabash3/issues/48" class="link">issue #48</a>
by supplying extension attributes to atomic steps.</p></li><li><p>Fixed
<a href="https://github.com/xmlcalabash/xmlcalabash3/issues/47" class="link">issue #47</a>
by documenting the <code class="option"><a href="running.html#cli-pipeline">pipeline</a></code> option.</p></li><li><p>Added support for a
<code class="option"><a href="running.html#cli-init">--init</a></code> command line option to support registering
extension functions before running a pipeline.</p></li><li><p>Refactored the API that provides inputs to atomic steps. The inputs are now
cached by the implementation and made available when the step is run. The previous API didn’t
require that inputs be cached, but the overwhelming majority of steps do. Centralizing
that feature simplifies atomic step implementations and avoids bugs.</p></li><li><p>Fixed a bug where <code class="tag tag-element">p:store</code> could not store binary outputs.
Generally improved handling of serialized outputs.
Implemented support for the <code class="tag tag-element"><a href="configuration.html#cc.serialization">cc:serialization</a></code>
configuration option.</p></li><li><p>Refactored the paged media steps. Documented the extensions supported by
<code class="tag tag-element"><a href="https://docs.xmlcalabash.com/reference/current/p-css-formatter.html">p:css-formatter</a></code>
and
<code class="tag tag-element"><a href="https://docs.xmlcalabash.com/reference/current/p-xsl-formatter.html">p:xsl-formatter</a></code>.
</p></li><li><p>Documented the <code class="function"><a href="https://docs.xmlcalabash.com/reference/current/xproc-functions.html#f.system-property">p:system-property</a></code> function, including the vendor-specific property
names.</p></li><li><p>Refactored the logging-related configuration. Switched to the
<a href="https://logback.qos.ch/" class="link">Logback</a> backend. Changed the
<code class="option"><a href="running.html#cli-debug">--debug</a></code> option so that it enables debug logging.
</p></li><li id="revision-verbosity"><p>Refactored and reorganized the <code class="option"><a href="running.html#cli-verbosity">--verbosity</a></code>
values. They now align with debugging log levels.</p></li><li><p>Refactored how “empty” is handled. Empty inputs are now addressed when the
graph model is built, not during pipeline construction. This simplifies construction
and fixed at least one bug.</p></li><li><p>Fixed a bug in the way the error explanations file was parsed.</p></li><li><p>Attempted to make sure that error messages include the location of the error.
Things are improved, though perhaps not fixed everywhere.</p></li><li><p>Refactored how step and model IDs are managed. The new system produces simpler,
more predictable APIs.</p></li></ul>
</div></div></li><li id="r300-alpha5" class="revision"><div class="revnumber"><span class="revnumber">3.0.0-alpha5</span>, <span class="date" time="2024-12-15">15 Dec 2024</span></div><div class="description"><div class="revdescription">
<ul class="itemizedlist"><li><p>Refactored the way context information is maintained both at
compile time and run time. This is a re-refactor of the refactor I
started back in June when I discovered that it must be possible for
the Saxon configuration for each step to be different. The problem I
discovered shortly after releasing <a href="#r300-alpha4" class="link">alpha4</a> was that the runtime context
was still using the compile time environment when evaluating
expressions. Mostly this manifested in the wrong value for the
<code class="literal">p:episode</code> system property.</p><p>It was all a bit of a mess so I threw it out and started over. Again. It’s better now,
I think, but there’s still room for improvement.</p></li><li><p>Updated the serializer to make sure that XHTML documents are serialized as XML, not HTML.</p></li><li><p>Added a stub implementation of <code class="function">p:lookup-uri</code>.</p></li><li><p>Fixed
<a href="https://github.com/xmlcalabash/xmlcalabash3/issues/32" class="link">issue #32</a>
by adding a (debug logging) warning if an input or output port
trivially accepts no documents. That is, if it has a content-types
constraint that includes no inclusive members or if
<code class="literal">*/*</code> is the last exclusive member.</p></li><li><p>Fixed
<a href="https://github.com/xmlcalabash/xmlcalabash3/issues/31" class="link">issue #31</a>
by amking some documentation improvements, including documenting the additional
properties accepted by <code class="function">p:system-property</code> in the
<cite class="citetitle"><a href="https://docs.xmlcalabash.com/reference/current/">Reference Guide</a></cite>.</p></li></ul>
</div></div></li><li id="r300-alpha4" class="revision"><div class="revnumber"><span class="revnumber">3.0.0-alpha4</span>, <span class="date" time="2024-12-07">07 Dec 2024</span></div><div class="description"><div class="revdescription">
<ul class="itemizedlist"><li><p>Resolved the remaining <code class="tag tag-element">p:validate-with-json-schema</code> test failures. Updated
to <a href="https://github.com/networknt/json-schema-validator" class="link">json-schema-validator</a>
version 1.5.4. This required adding a dependency on GraalVM’s polyglot JavaScript library.
</p></li><li><p>Updated the build script to use a more recent version of XercesImpl.</p></li><li><p>Fixed several bugs related to the way static options are resolved.</p></li><li><p>Fixed a bug where <code>[p:]inline-expand-text</code> was incorrectly controlling
AVTs in attributes on the element where it occurred.</p></li><li><p>Made many improvements to <code class="tag tag-element">p:import-functions</code> support.</p></li><li><p>Added <a href="https://github.com/xproc/3.0-test-suite/pull/774" class="link">special
handling</a> for <code class="tag tag-attribute">use-when</code> on <code class="tag tag-element">p:import</code>.</p></li><li><p>Support variables in <code class="tag tag-attribute">match</code> expressions on
<code class="tag tag-element">p:viewport</code>.</p></li><li><p>Fixed error codes for several tests. Correctly report static errors in more cases.</p></li><li><p>Reworked SVG output so that there’s one file for all the pipelines and
one file for all the graphs (instead of multiple files for each).</p></li><li><p>Added support for the <code class="option">--step</code> option.</p></li><li><p>Fixed a bug in the attribute value template parser. It failed to handle
nested comments correctly.</p></li></ul>
</div></div></li><li id="r300-alpha3" class="revision"><div class="revnumber"><span class="revnumber">3.0.0-alpha3</span>, <span class="date" time="2024-12-02">02 Dec 2024</span></div><div class="description"><div class="revdescription">
<ul class="itemizedlist"><li><p>Fixed
<a href="https://github.com/xmlcalabash/xmlcalabash3/issues/9" class="link">issue #9</a>,
which reveals that the XPath parser is still a bit too ad hoc.</p></li><li><p>Fixed a couple of NVDL tests by sorting out the cache for schemas.
Updated the <code class="tag tag-element">p:xinclude</code> step so that it looks in the cache.
</p></li><li><p>Added <code class="tag tag-element">cx:cache-add</code> and <code class="tag tag-element">cx:cache-delete</code> to let pipeline
authors update the cache.</p></li><li><p>Made a bunch of improvements to static option handling.</p></li><li><p>Resolved the situation where two steps with the same type (private steps in different
libraries, for example) would not work correctly.</p></li><li><p>These changes resolved the remaining input, option, with-option, step-available, and
<code class="tag tag-element">p:run</code> tests.</p></li></ul>
</div></div></li><li id="r300-alpha2" class="revision"><div class="revnumber"><span class="revnumber">3.0.0-alpha2</span>, <span class="date" time="2024-11-26">26 Nov 2024</span></div><div class="description"><div class="revdescription">
<ul class="itemizedlist"><li><p>Fixed
<a href="https://github.com/xmlcalabash/xmlcalabash3/issues/3" class="link">issue #3</a>,
<code class="literal">[p:]message</code> attributes were not supported on steps.
</p></li><li><p>Attempted to fix
<a href="https://github.com/xmlcalabash/xmlcalabash3/issues/2" class="link">issue #2</a>,
XML Calabash failed on startup on Windows. The problem, correctly identified by Martin,
was in the attempt to create a URI from a path. On Windows, paths contain <code class="literal">\</code>
and those are forbidden in URIs.</p><p>I’ve adopted the solution suggested by Martin, and tested that it passes a “smoke test”
on Windows. But I’m not highly confident that this is the end of the Windows path issues.</p></li><li><p>Removed “empty steps” from the runtime graph. These are steps that
generate no output, designed to model <code class="tag tag-element">p:empty</code> bindings. They clutter
the graph and I don’t think they’re required any more. An unbound input is now
“welded shut” so that no inputs are expected.</p></li></ul>
</div></div></li><li id="r300-alpha1" class="revision"><div class="revnumber"><span class="revnumber">3.0.0-alpha1</span>, <span class="date" time="2024-11-24">24 Nov 2024</span></div><div class="description"><div class="revdescription">
<p>Initial publication.</p>
</div></div></li></ul></div></section></main><nav class="bottom"><table><tr><td class="previous"><a href="tracing.html">Prev</a></td><td class="up"><a href="index.html">Up</a></td><td class="next"></td></tr><tr><td class="previous">Appendix <span class="label">B</span><span class="sep">. </span>Tracing execution</td><td class="up"><a href="index.html">Home</a></td><td class="next"></td></tr></table><nav class="tocopen"></nav><nav class="toc"></nav><!-- Hide ToC details from user agents that don’t support JS --><script type="text/html" class="tocopen"><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAQCAYAAAAWGF8bAAAACXBIWXMAABYlAAAWJQFJUiTwAAABDklEQVQ4je2UUW3EMAyGv0wDUAhlkDBIyuAYXCEclEJoGZRBUgYOgzJoGHgPW6o7rWq35+2TIkWW9duW7N+oKuM46jiOGGMAaNsW5xzee5xzn8EvRESXZUFEWNcVAFWl73v6vjcGUIAYIyEEANZ1RUSY55lSCo/HA4BhGGiahtvthnOOtm0BSCnRdd1eVAGNMeoR27aptVattbpt22FOjFGrzjsX1I7q/4q3y4xf8i/4FwT3Pcw5Y4zBWvujfQMopZBzJuf8XbCeVyWEgHOO+/2+x0SEaZpIKSEih0X2Wz6jdlxKuezaqL7qpZS0lLKbw/M4ANba3RyapiGE8OJGqOrpizGq916999VATvM/AGFn1sxsVjL5AAAAAElFTkSuQmCC" alt="[toc]"/></script><script type="text/html" class="toc"><header><span>Table of Contents</span><span class="close"><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAYAAAAf8/9hAAAACXBIWXMAABYlAAAWJQFJUiTwAAAAtklEQVQ4jaWT0Q3DIAxEz52AEbyB2cDZhBEY3SNcPyqqBEwqpZaQAHNP5jBCEiJCPAiSIgAeiUe8zoveO9x9e9jd0XtfKwHA1hpHtNY49rO8u59zn4mqMiJSyFkcEVTVFQCAtdYFMotrrXN111JnyA/xCsggN2JeXmGEmaGU8l2XUmBm29fZuh0RW2PTK2SGZcamADPb3nmGmNkKOI7j1rAzJG2kcWhqkstQ1QX+/2ciKU/FJOUN6JFZYWpmK3sAAAAASUVORK5CYII=" alt="X"/></span><p class="ptoc-search"><input class="ptoc-search" placeholder="Search" style="width: 80%"/></p></header><div db-persistent-toc="persistent-toc.html" db-prefix="">Loading…</div></script></nav></body></html>