<!DOCTYPE html><html xmlns="http://www.w3.org/1999/xhtml" class="no-js"><head><meta http-equiv="Content-Type" content="text/html; charset=utf-8"/><script>(function(H){H.className=H.className.replace(/\bno-js\b/,'js')})(document.documentElement)</script><title>Appendix B. Tracing execution</title><link href="./css/pygments.css" rel="stylesheet"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><link href="https://purl.org/dc/elements/1.1/" rel="schema.dc"/><meta name="dc.modified" content="2024-12-24T14:35:50Z"/><meta name="generator" content="DocBook xslTNG version 2.5.0 / 855db8f2 / SAXON HE 12.5"/><link href="./css/docbook-toc.css" rel="stylesheet"/><link href="./css/docbook.css" rel="stylesheet" media="screen"/><link href="img/icon.png" rel="shortcut icon"/><link href="./css/xmlcalabash.css" rel="stylesheet"/><link href="./css/xproc.css" rel="stylesheet"/><link rel="prev" href="configuration.html"/><link rel="next" href="changelog.html"/><link rel="up" href="index.html"/><link rel="home" href="index.html"/><script src="./js/persistent-toc.js" defer="defer"></script><script src="./js/chunk-nav.js" defer="defer"></script></head><body class="appendix component"><nav class="top"><div><a href="index.html">Home</a> <a href="index.html">Up</a> <a href="changelog.html">Next</a> <a href="configuration.html">Prev</a></div></nav><main><section id="tracing" db-chunk="tracing.html" db-id="d110e2208" class="appendix component"><header><h2>Appendix <span class="label">B</span><span class="sep">. </span>Tracing execution</h2></header><div class="db-bfs"><p>The <code class="option"><a href="running.html#cli-trace">--trace</a></code> option can
be used to create a trace of the execution of a pipeline.
If the <code class="option"><a href="running.html#cli-trace-documents">--trace-documents</a></code> option is used,
a copy of every document that flows through the pipeline will be saved.</p><p>Trace documents are in the
“<code class="uri">https://xmlcalabash.com/ns/trace</code>” namespace.</p><p>The traces are divided by threads (at the moment, there’s only one
thread). Within each thread, each step is recorded along with details about its
execution. There are two logical views of the trace: execution order and
execution structure. The step start tags are in execution order, earlier steps
precede later ones. The hierarchical structure of steps is also significant.
Compound steps are nested according to how they were executed.</p><p>Documents also appear in execution order, and in execution order within
the steps. Their position in the hierarchy <em>is not</em>
(especially) significant. Just because a document appears as a child of a particular
step does not imply that the parent step generated. The source and target of each
document is explicitly identified with the document.</p></div><section id="tracing_s1" class="section"><header><h2>The trace vocabulary</h2></header><p id="d4242e0" class="element-syntax element-syntax-language-construct"><code>&lt;t:trace&gt;<br/>    <a href="#t.thread">t:thread</a>+<br/>&lt;/t:trace&gt;</code></p><p>A trace consists of one or more threads of execution.</p><section id="t.thread" class="section"><header><h3>Threads</h3></header><p id="d4255e0" class="element-syntax element-syntax-language-construct"><code>&lt;t:thread<br/>  <strong>id</strong> = <var>long</var>&gt;<br/>    (<a href="#t.step">t:step</a> | <br/>     <a href="#t.document">t:document</a>)+<br/>&lt;/t:thread&gt;</code></p><p>A thread has an id (it’s runtime thread id) and one or more steps. It may incidentally
have document children as well.</p></section><section id="t.step" class="section"><header><h3>Steps</h3></header><p id="d4272e0" class="element-syntax element-syntax-language-construct"><code>&lt;t:step<br/>  <strong>id</strong> = <var>string</var><br/>  <strong>name</strong> = <var>string</var><br/>  <strong>type</strong> = <var>EQName</var><br/>  <strong>start-time</strong> = <var>dateTime</var><br/>  <strong>duration-ms</strong> = <var>long</var>&gt;<br/>    (<a href="#t.step">t:step</a> | <br/>     <a href="#t.document">t:document</a>)*<br/>&lt;/t:step&gt;</code></p><p>Each step has several attributes:</p><dl class="variablelist"><div class="varlistentry"><dt><span class="term"><code class="tag tag-attribute">id</code></span></dt><dd><p>An id; this is a unique ID for this instantiation of this step. (In recursive pipelines, the
same step may be instantiated more than once.)</p></dd></div><div class="varlistentry"><dt><span class="term"><code class="tag tag-attribute">name</code></span></dt><dd><p>A name; this is derived from the step’s name in the pipeline, if it has one. </p></dd></div><div class="varlistentry"><dt><span class="term"><code class="tag tag-attribute">type</code></span></dt><dd><p>The step type. User-defined pipelines appear in the trace with the
type <code class="tag tag-element">p:declare-step</code>. That represents the invocation of their subpipeline.</p></dd></div><div class="varlistentry"><dt><span class="term"><code class="tag tag-attribute">start-time</code></span></dt><dd><p>The start time; this is the “wall-clock” time when execution of this step began.</p></dd></div><div class="varlistentry"><dt><span class="term"><code class="tag tag-attribute">duration-ms</code></span></dt><dd><p>How long the step executed. This is a value in milliseconds.</p></dd></div></dl><p>A compound step will contain the execution traces for the steps it contains.
It may also include documents.</p></section><section id="t.document" class="section"><header><h3>Documents</h3></header><p id="d4317e0" class="element-syntax element-syntax-language-construct"><code>&lt;t:document<br/>  <strong>id</strong> = <var>long</var><br/>  content-type? = <var>string</var>&gt;<br/>    (<a href="#t.from">t:from</a>,<br/>     <a href="#t.to">t:to</a>,<br/>     <a href="#t.location">t:location</a>?)<br/>&lt;/t:document&gt;</code></p><p>Each document has an id. This is a unique id for this document. Documents are immutable,
so if the same document is passed between multiple steps, it will appear in multiple document
elements.</p><p>If the document has a content type, that’s also recorded.</p><p>If the <code class="option"><a href="running.html#cli-trace-documents">--trace-documents</a></code> option is used,
each document will also have a
<code class="tag tag-element">location</code> element.</p><section id="t.from" class="section"><header><h4>From</h4></header><p id="d4333e0" class="element-syntax element-syntax-language-construct"><code>&lt;t:from<br/>  <strong>id</strong> = <var>string</var><br/>  <strong>port</strong> = <var>string</var> /&gt;</code></p><p>Identifies the step that the produced the document, by id and port name.</p></section><section id="t.to" class="section"><header><h4>To</h4></header><p id="d4345e0" class="element-syntax element-syntax-language-construct"><code>&lt;t:to<br/>  <strong>id</strong> = <var>string</var><br/>  <strong>port</strong> = <var>string</var> /&gt;</code></p><p>Identifies the step that received the document by, id and port name.</p></section><section id="t.location" class="section"><header><h4>Location</h4></header><p id="d4356e0" class="element-syntax element-syntax-language-construct"><code>&lt;t:location<br/>  <strong>filename</strong> = <var>string</var> /&gt;</code></p><p>Identifies the filename where the document has been stored.</p></section></section></section></section></main><nav class="bottom"><table><tr><td class="previous"><a href="configuration.html">Prev</a></td><td class="up"><a href="index.html">Up</a></td><td class="next"><a href="changelog.html">Next</a></td></tr><tr><td class="previous">Appendix <span class="label">A</span><span class="sep">. </span>Configuration</td><td class="up"><a href="index.html">Home</a></td><td class="next">Appendix <span class="label">C</span><span class="sep">. </span>Change log</td></tr></table><nav class="tocopen"></nav><nav class="toc"></nav><!-- Hide ToC details from user agents that don’t support JS --><script type="text/html" class="tocopen"><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAQCAYAAAAWGF8bAAAACXBIWXMAABYlAAAWJQFJUiTwAAABDklEQVQ4je2UUW3EMAyGv0wDUAhlkDBIyuAYXCEclEJoGZRBUgYOgzJoGHgPW6o7rWq35+2TIkWW9duW7N+oKuM46jiOGGMAaNsW5xzee5xzn8EvRESXZUFEWNcVAFWl73v6vjcGUIAYIyEEANZ1RUSY55lSCo/HA4BhGGiahtvthnOOtm0BSCnRdd1eVAGNMeoR27aptVattbpt22FOjFGrzjsX1I7q/4q3y4xf8i/4FwT3Pcw5Y4zBWvujfQMopZBzJuf8XbCeVyWEgHOO+/2+x0SEaZpIKSEih0X2Wz6jdlxKuezaqL7qpZS0lLKbw/M4ANba3RyapiGE8OJGqOrpizGq916999VATvM/AGFn1sxsVjL5AAAAAElFTkSuQmCC" alt="[toc]"/></script><script type="text/html" class="toc"><header><span>Table of Contents</span><span class="close"><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAYAAAAf8/9hAAAACXBIWXMAABYlAAAWJQFJUiTwAAAAtklEQVQ4jaWT0Q3DIAxEz52AEbyB2cDZhBEY3SNcPyqqBEwqpZaQAHNP5jBCEiJCPAiSIgAeiUe8zoveO9x9e9jd0XtfKwHA1hpHtNY49rO8u59zn4mqMiJSyFkcEVTVFQCAtdYFMotrrXN111JnyA/xCsggN2JeXmGEmaGU8l2XUmBm29fZuh0RW2PTK2SGZcamADPb3nmGmNkKOI7j1rAzJG2kcWhqkstQ1QX+/2ciKU/FJOUN6JFZYWpmK3sAAAAASUVORK5CYII=" alt="X"/></span><p class="ptoc-search"><input class="ptoc-search" placeholder="Search" style="width: 80%"/></p></header><div db-persistent-toc="persistent-toc.html" db-prefix="">Loading…</div></script></nav></body></html>