<!DOCTYPE html><html xmlns="http://www.w3.org/1999/xhtml" class="no-js"><head><meta http-equiv="Content-Type" content="text/html; charset=utf-8"/><script>(function(H){H.className=H.className.replace(/\bno-js\b/,'js')})(document.documentElement)</script><title>p:add-attribute</title><link href="./css/pygments.css" rel="stylesheet"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><link href="https://purl.org/dc/elements/1.1/" rel="schema.dc"/><meta name="dc.modified" content="2024-12-01T11:59:39Z"/><meta name="generator" content="DocBook xslTNG version 2.5.0 / 855db8f2 / SAXON HE 12.5"/><link href="./css/docbook-toc.css" rel="stylesheet"/><link href="./css/docbook.css" rel="stylesheet" media="screen"/><link href="img/icon.png" rel="shortcut icon"/><link href="./css/xmlcalabash.css" rel="stylesheet"/><link href="./css/xproc.css" rel="stylesheet"/><link rel="prev" href="standard-steps.html"/><link rel="next" href="p-add-xml-base.html"/><link rel="up" href="standard-steps.html"/><link rel="home" href="index.html"/><script src="./js/persistent-toc.js" defer="defer"></script><script src="./js/copy-verbatim.js" defer="defer"></script><script src="./js/chunk-nav.js" defer="defer"></script></head><body class="component refentry"><nav class="top"><div><a href="index.html">Home</a> <a href="standard-steps.html">Up</a> <a href="p-add-xml-base.html">Next</a> <a href="standard-steps.html">Prev</a></div></nav><main><section id="p-add-attribute" db-chunk="p-add-attribute.html" db-id="d111e150" class="component refentry"><div id="p-add-attribute_refnamediv1" class="refnamediv"><header><h2>Name</h2></header><p><span class="refname">p:add-attribute</span><span class="refpurpose"><span class="refpurpose-sep"> — </span><span class="refpurpose-text">The standard p:add-attribute step</span><span class="refpurpose-punc">.</span></span></p></div><section id="p-add-attribute_refsynopsisdiv1" class="refsynopsisdiv"><header><h2>Synopsis</h2></header>

<p>The <code>p:add-attribute</code> step adds a single attribute to
a set of matching elements. The input document specified on the
  <code>source</code> is processed for matches specified by the 
    <span class="glossterm"><a href="glossary.html#glossary_ge4">selection pattern</a></span> in the <code class="option">match</code> option. For each of these
matches, the attribute whose name is specified by the
<code class="option">attribute-name</code> option is set to the attribute value
specified by the <code class="option">attribute-value</code> option.
</p><p>The resulting document is produced on the <code>result</code>
output port and consists of a exact copy of the input with the
exception of the matched elements. Each of the matched elements is
copied to the output with the addition of the specified attribute
with the specified value.
</p>


<div class="declare-step"><table class="tableaux"><thead><tr><th class="port">Input port</th><th class="check">Primary</th><th class="check">Sequence</th><th>Content types</th></tr></thead><tbody><tr><td class="primary">source</td><td class="check">✔ </td><td class="check"> </td><td>xml html </td></tr></tbody></table><table class="tableaux"><thead><tr><th class="port">Output port</th><th class="check">Primary</th><th class="check">Sequence</th><th>Content types</th></tr></thead><tbody><tr><td class="primary">result</td><td class="check">✔ </td><td class="check"> </td><td>xml html </td></tr></tbody></table><table class="tableaux"><thead><tr><th class="optname">Option name</th><th>Type</th><th>Default value</th><th class="check">Required</th></tr></thead><tbody><tr><td class="required">attribute-name</td><td>xs:QName</td><td> </td><td class="check">✔ </td></tr><tr><td class="required">attribute-value</td><td>xs:string</td><td> </td><td class="check">✔ </td></tr><tr><td class="optname">match</td><td>XSLTSelectionPattern</td><td>'/*'</td><td class="check"> </td></tr></tbody></table><details><summary>Declaration</summary><div class="pre-wrap programlisting-wrap highlight" db-startinglinenumber="1" db-numberoflines="11"><pre class="language-xml long numbered programlisting verbatim verblines"><span class="line" db-line="1"><span class="ln"> 1 <span class="nsep">|</span></span><span class="ld"><code><span class="nt">&lt;p:declare-step</span> <span class="na">xmlns:p=</span><span class="s">"http://www.w3.org/ns/xproc"</span><span class="nt">&gt;</span></code></span></span>
<span class="line" db-line="2"><span class="ln">   <span class="nsep">|</span></span><span class="ld"><code>   <span class="nt">&lt;p:input</span> <span class="na">port=</span><span class="s">"source"</span> <span class="na">content-types=</span><span class="s">"xml html"</span><span class="nt">/&gt;</span></code></span></span>
<span class="line" db-line="3"><span class="ln">   <span class="nsep">|</span></span><span class="ld"><code>   <span class="nt">&lt;p:output</span> <span class="na">port=</span><span class="s">"result"</span> <span class="na">content-types=</span><span class="s">"xml html"</span><span class="nt">/&gt;</span></code></span></span>
<span class="line" db-line="4"><span class="ln">   <span class="nsep">|</span></span><span class="ld"><code>   <span class="nt">&lt;p:option</span> <span class="na">xmlns:e=</span><span class="s">"http://www.w3.org/1999/XSL/Spec/ElementSyntax"</span></code></span></span>
<span class="line" db-line="5"><span class="ln"> 5 <span class="nsep">|</span></span><span class="ld"><code>             <span class="na">name=</span><span class="s">"match"</span></code></span></span>
<span class="line" db-line="6"><span class="ln">   <span class="nsep">|</span></span><span class="ld"><code>             <span class="na">as=</span><span class="s">"xs:string"</span></code></span></span>
<span class="line" db-line="7"><span class="ln">   <span class="nsep">|</span></span><span class="ld"><code>             <span class="na">select=</span><span class="s">"'/*'"</span></code></span></span>
<span class="line" db-line="8"><span class="ln">   <span class="nsep">|</span></span><span class="ld"><code>             <span class="na">e:type=</span><span class="s">"XSLTSelectionPattern"</span><span class="nt">/&gt;</span></code></span></span>
<span class="line" db-line="9"><span class="ln">   <span class="nsep">|</span></span><span class="ld"><code>   <span class="nt">&lt;p:option</span> <span class="na">name=</span><span class="s">"attribute-name"</span> <span class="na">required=</span><span class="s">"true"</span> <span class="na">as=</span><span class="s">"xs:QName"</span><span class="nt">/&gt;</span></code></span></span>
<span class="line" db-line="10"><span class="ln">10 <span class="nsep">|</span></span><span class="ld"><code>   <span class="nt">&lt;p:option</span> <span class="na">name=</span><span class="s">"attribute-value"</span> <span class="na">required=</span><span class="s">"true"</span> <span class="na">as=</span><span class="s">"xs:string"</span><span class="nt">/&gt;</span></code></span></span>
<span class="line" db-line="11"><span class="ln">   <span class="nsep">|</span></span><span class="ld"><code><span class="nt">&lt;/p:declare-step&gt;</span></code></span></span></pre></div></details></div>
<details><summary>Errors</summary><table class="tableaux error-list"><thead><tr><th class="code">Code</th><th>Description</th></tr></thead><tbody><tr><td class="code"><a class="exlink" href="https://spec.xproc.org/master/head/steps/#err.C0023"><code>err:XC0023</code></a></td><td>It
is a <span class="glossterm"><span class="glossterm"><a href="glossary.html#glossary_ge1">dynamic error</a></span> (<code>err:XC0023</code>)</span> if the <span class="glossterm"><span class="glossterm"><a href="glossary.html#glossary_ge4">selection pattern</a></span> (<code>err:XC0023</code>)</span> matches a node
which is not an element.</td></tr><tr><td class="code"><a class="exlink" href="https://spec.xproc.org/master/head/steps/#err.C0059"><code>err:XC0059</code></a></td><td>It is a <span class="glossterm"><span class="glossterm"><a href="glossary.html#glossary_ge1">dynamic error</a></span> (<code>err:XC0059</code>)</span> if the QName
value in the <code class="option">attribute-name</code> option is “<code>xmlns</code>” or uses the prefix
“<code class="literal">xmlns</code>”
or any other prefix that resolves to the namespace name
<code class="uri">http://www.w3.org/2000/xmlns/</code>.
</td></tr></tbody></table></details></section><section id="p-add-attribute_refsection1" class="refsection"><header><h2>Description</h2></header>
   
   <p>TBD.</p>
</section><section id="p-add-attribute_refsection2" class="refsection"><header><h2>Examples</h2></header>


<p>Applied to the <a href="running-example.html" class="link">running example</a>, this
pipeline:</p>

<div class="pre-wrap programlisting-wrap highlight" db-startinglinenumber="1" db-numberoflines="14"><pre class="language-xml long numbered programlisting verbatim verblines"><span class="line" db-line="1"><span class="ln"> 1 <span class="nsep">|</span></span><span class="ld"><code><span class="nt">&lt;p:declare-step</span> <span class="na">version=</span><span class="s">"3.1"</span></code></span></span>
<span class="line" db-line="2"><span class="ln">   <span class="nsep">|</span></span><span class="ld"><code>                <span class="na">xmlns:p=</span><span class="s">"http://www.w3.org/ns/xproc"</span></code></span></span>
<span class="line" db-line="3"><span class="ln">   <span class="nsep">|</span></span><span class="ld"><code>                <span class="na">xmlns:ex=</span><span class="s">"https://xmlcalabash.com/ns/examples"</span><span class="nt">&gt;</span></code></span></span>
<span class="line" db-line="4"><span class="ln">   <span class="nsep">|</span></span><span class="ld"><code>  <span class="nt">&lt;p:input</span> <span class="na">port=</span><span class="s">"source"</span><span class="nt">/&gt;</span></code></span></span>
<span class="line" db-line="5"><span class="ln"> 5 <span class="nsep">|</span></span><span class="ld"><code>  <span class="nt">&lt;p:output</span> <span class="na">port=</span><span class="s">"result"</span><span class="nt">/&gt;</span></code></span></span>
<span class="line" db-line="6"><span class="ln">   <span class="nsep">|</span></span><span class="ld"><code> </code></span></span>
<span class="line" db-line="7"><span class="ln">   <span class="nsep">|</span></span><span class="ld"><code>  <span class="nt">&lt;p:add-attribute</span> <span class="na">match=</span><span class="s">"//ex:doc"</span></code></span></span>
<span class="line" db-line="8"><span class="ln">   <span class="nsep">|</span></span><span class="ld"><code>                   <span class="na">attribute-name=</span><span class="s">"status"</span></code></span></span>
<span class="line" db-line="9"><span class="ln">   <span class="nsep">|</span></span><span class="ld"><code>                   <span class="na">attribute-value=</span><span class="s">"draft"</span><span class="nt">/&gt;</span></code></span></span>
<span class="line" db-line="10"><span class="ln">10 <span class="nsep">|</span></span><span class="ld"><code> </code></span></span>
<span class="line" db-line="11"><span class="ln">   <span class="nsep">|</span></span><span class="ld"><code>  <span class="nt">&lt;p:add-attribute</span> <span class="na">match=</span><span class="s">"//ex:chap"</span></code></span></span>
<span class="line" db-line="12"><span class="ln">   <span class="nsep">|</span></span><span class="ld"><code>                   <span class="na">attribute-name=</span><span class="s">"class"</span></code></span></span>
<span class="line" db-line="13"><span class="ln">   <span class="nsep">|</span></span><span class="ld"><code>                   <span class="na">attribute-value=</span><span class="s">"chapter"</span><span class="nt">/&gt;</span></code></span></span>
<span class="line" db-line="14"><span class="ln">   <span class="nsep">|</span></span><span class="ld"><code><span class="nt">&lt;/p:declare-step&gt;</span></code></span></span></pre></div>

<p>Produces this output:</p>

<div class="panelset variablelist"><div class="panelset"><input type="radio" name="tabs_p-add-attribute_refsection2_vl1" id="p-add-attribute_refsection2_vl1_vle1" style="display:none" checked="checked"/><label for="p-add-attribute_refsection2_vl1_vle1">XML output</label><div class="paneltab"><div class="pre-wrap programlisting-wrap highlight" db-startinglinenumber="1" db-numberoflines="18"><pre class="language-xml long numbered programlisting verbatim verblines"><span class="line" db-line="1"><span class="ln"> 1 <span class="nsep">|</span></span><span class="ld"><code><span class="nt">&lt;doc</span> <span class="na">xmlns=</span><span class="s">"https://xmlcalabash.com/ns/examples"</span></code></span></span>
<span class="line" db-line="2"><span class="ln">   <span class="nsep">|</span></span><span class="ld"><code>     <span class="na">xmlns:xi=</span><span class="s">"http://www.w3.org/2001/XInclude"</span></code></span></span>
<span class="line" db-line="3"><span class="ln">   <span class="nsep">|</span></span><span class="ld"><code>     <span class="na">class=</span><span class="s">"book"</span></code></span></span>
<span class="line" db-line="4"><span class="ln">   <span class="nsep">|</span></span><span class="ld"><code>     <span class="na">status=</span><span class="s">"draft"</span><span class="nt">&gt;</span></code></span></span>
<span class="line" db-line="5"><span class="ln"> 5 <span class="nsep">|</span></span><span class="ld"><code>   <span class="nt">&lt;chap</span> <span class="na">former=</span><span class="s">"1"</span> <span class="na">class=</span><span class="s">"chapter"</span><span class="nt">&gt;</span></code></span></span>
<span class="line" db-line="6"><span class="ln">   <span class="nsep">|</span></span><span class="ld"><code>      <span class="nt">&lt;title&gt;</span>First Chapter<span class="nt">&lt;/title&gt;</span></code></span></span>
<span class="line" db-line="7"><span class="ln">   <span class="nsep">|</span></span><span class="ld"><code>      <span class="nt">&lt;p&gt;</span>…<span class="nt">&lt;/p&gt;</span></code></span></span>
<span class="line" db-line="8"><span class="ln">   <span class="nsep">|</span></span><span class="ld"><code>   <span class="nt">&lt;/chap&gt;</span></code></span></span>
<span class="line" db-line="9"><span class="ln">   <span class="nsep">|</span></span><span class="ld"><code>   <span class="nt">&lt;xi:include</span> <span class="na">href=</span><span class="s">"default-ch2.xml"</span><span class="nt">/&gt;</span></code></span></span>
<span class="line" db-line="10"><span class="ln">10 <span class="nsep">|</span></span><span class="ld"><code>   <span class="nt">&lt;chap</span> <span class="na">class=</span><span class="s">"chapter"</span><span class="nt">&gt;</span></code></span></span>
<span class="line" db-line="11"><span class="ln">   <span class="nsep">|</span></span><span class="ld"><code>      <span class="nt">&lt;title&gt;</span>Third Chapter<span class="nt">&lt;/title&gt;</span></code></span></span>
<span class="line" db-line="12"><span class="ln">   <span class="nsep">|</span></span><span class="ld"><code>      <span class="nt">&lt;p&gt;</span>…<span class="nt">&lt;/p&gt;</span></code></span></span>
<span class="line" db-line="13"><span class="ln">   <span class="nsep">|</span></span><span class="ld"><code>   <span class="nt">&lt;/chap&gt;</span></code></span></span>
<span class="line" db-line="14"><span class="ln">   <span class="nsep">|</span></span><span class="ld"><code>   <span class="nt">&lt;app&gt;</span></code></span></span>
<span class="line" db-line="15"><span class="ln">15 <span class="nsep">|</span></span><span class="ld"><code>      <span class="nt">&lt;title&gt;</span>Appendix<span class="nt">&lt;/title&gt;</span></code></span></span>
<span class="line" db-line="16"><span class="ln">   <span class="nsep">|</span></span><span class="ld"><code>      <span class="nt">&lt;p&gt;</span>…<span class="nt">&lt;/p&gt;</span></code></span></span>
<span class="line" db-line="17"><span class="ln">   <span class="nsep">|</span></span><span class="ld"><code>   <span class="nt">&lt;/app&gt;</span></code></span></span>
<span class="line" db-line="18"><span class="ln">   <span class="nsep">|</span></span><span class="ld"><code><span class="nt">&lt;/doc&gt;</span></code></span></span></pre></div></div><input type="radio" name="tabs_p-add-attribute_refsection2_vl1" id="p-add-attribute_refsection2_vl1_vle2" style="display:none"/><label for="p-add-attribute_refsection2_vl1_vle2">Changes</label><div class="paneltab"><p>This listing attempts to summarize what has changed from the original input.</p><div class="pre-wrap programlisting-wrap" db-startinglinenumber="1" db-numberoflines="17"><pre class="language-none long numbered programlisting verbatim"><code>&lt;doc xmlns="https://xmlcalabash.com/ns/examples"
     class="book" <span class="phrase revadded">status="draft"</span>&gt;
&lt;chap former="1" class="<span class="phrase revchanged">chapter</span>"&gt;
&lt;title&gt;First Chapter&lt;/title&gt;
&lt;p&gt;…&lt;/p&gt;
&lt;/chap&gt;
&lt;xi:include xmlns:xi="http://www.w3.org/2001/XInclude"
            href="default-ch2.xml"/&gt;
&lt;chap <span class="phrase revadded">class="chapter"</span>&gt;
<span class="phrase revadded"></span>&lt;title&gt;Third Chapter&lt;/title&gt;
&lt;p&gt;…&lt;/p&gt;
&lt;/chap&gt;
&lt;app&gt;
&lt;title&gt;Appendix&lt;/title&gt;
&lt;p&gt;…&lt;/p&gt;
&lt;/app&gt;
&lt;/doc&gt;</code></pre></div><p>When present, additions are shown in <code class="revadded">bold, green</code>;
  deletions are shown in
  <code class="revdeleted">italic, red with strike through</code>;
  and changed elements are shown in
  <code class="revchanged">bold, italic orange</code>.</p></div><input type="radio" name="tabs_p-add-attribute_refsection2_vl1" id="p-add-attribute_refsection2_vl1_vle3" style="display:none"/><label for="p-add-attribute_refsection2_vl1_vle3">XML input</label><div class="paneltab"><div class="pre-wrap programlisting-wrap highlight" db-startinglinenumber="1" db-numberoflines="15"><pre class="language-xml long numbered programlisting verbatim verblines"><span class="line" db-line="1"><span class="ln"> 1 <span class="nsep">|</span></span><span class="ld"><code><span class="nt">&lt;doc</span> <span class="na">xmlns=</span><span class="s">"https://xmlcalabash.com/ns/examples"</span></code></span></span>
<span class="line" db-line="2"><span class="ln">   <span class="nsep">|</span></span><span class="ld"><code>     <span class="na">xmlns:xi=</span><span class="s">"http://www.w3.org/2001/XInclude"</span></code></span></span>
<span class="line" db-line="3"><span class="ln">   <span class="nsep">|</span></span><span class="ld"><code>     <span class="na">class=</span><span class="s">"book"</span><span class="nt">&gt;</span></code></span></span>
<span class="line" db-line="4"><span class="ln">   <span class="nsep">|</span></span><span class="ld"><code>  <span class="nt">&lt;chap</span> <span class="na">former=</span><span class="s">"1"</span> <span class="na">class=</span><span class="s">"test"</span><span class="nt">&gt;</span></code></span></span>
<span class="line" db-line="5"><span class="ln"> 5 <span class="nsep">|</span></span><span class="ld"><code>    <span class="nt">&lt;title&gt;</span>First Chapter<span class="nt">&lt;/title&gt;</span></code></span></span>
<span class="line" db-line="6"><span class="ln">   <span class="nsep">|</span></span><span class="ld"><code>    <span class="nt">&lt;p&gt;</span>…<span class="nt">&lt;/p&gt;</span></code></span></span>
<span class="line" db-line="7"><span class="ln">   <span class="nsep">|</span></span><span class="ld"><code>  <span class="nt">&lt;/chap&gt;</span></code></span></span>
<span class="line" db-line="8"><span class="ln">   <span class="nsep">|</span></span><span class="ld"><code>  <span class="nt">&lt;xi:include</span> <span class="na">href=</span><span class="s">"default-ch2.xml"</span><span class="nt">/&gt;</span></code></span></span>
<span class="line" db-line="9"><span class="ln">   <span class="nsep">|</span></span><span class="ld"><code>  <span class="nt">&lt;chap&gt;&lt;title&gt;</span>Third Chapter<span class="nt">&lt;/title&gt;</span></code></span></span>
<span class="line" db-line="10"><span class="ln">10 <span class="nsep">|</span></span><span class="ld"><code>  <span class="nt">&lt;p&gt;</span>…<span class="nt">&lt;/p&gt;</span></code></span></span>
<span class="line" db-line="11"><span class="ln">   <span class="nsep">|</span></span><span class="ld"><code>  <span class="nt">&lt;/chap&gt;</span></code></span></span>
<span class="line" db-line="12"><span class="ln">   <span class="nsep">|</span></span><span class="ld"><code>  <span class="nt">&lt;app&gt;&lt;title&gt;</span>Appendix<span class="nt">&lt;/title&gt;</span></code></span></span>
<span class="line" db-line="13"><span class="ln">   <span class="nsep">|</span></span><span class="ld"><code>  <span class="nt">&lt;p&gt;</span>…<span class="nt">&lt;/p&gt;</span></code></span></span>
<span class="line" db-line="14"><span class="ln">   <span class="nsep">|</span></span><span class="ld"><code>  <span class="nt">&lt;/app&gt;</span></code></span></span>
<span class="line" db-line="15"><span class="ln">15 <span class="nsep">|</span></span><span class="ld"><code><span class="nt">&lt;/doc&gt;</span></code></span></span></pre></div></div></div></div>
</section></section></main><nav class="bottom"><table><tr><td class="previous"><a href="standard-steps.html">Prev</a></td><td class="up"><a href="standard-steps.html">Up</a></td><td class="next"><a href="p-add-xml-base.html">Next</a></td></tr><tr><td class="previous"><span class="label">I</span><span class="sep">. </span>Standard steps</td><td class="up"><a href="index.html">Home</a></td><td class="next">p:add-xml-base</td></tr></table><nav class="tocopen"></nav><nav class="toc"></nav><!-- Hide ToC details from user agents that don’t support JS --><script type="text/html" class="tocopen"><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAQCAYAAAAWGF8bAAAACXBIWXMAABYlAAAWJQFJUiTwAAABDklEQVQ4je2UUW3EMAyGv0wDUAhlkDBIyuAYXCEclEJoGZRBUgYOgzJoGHgPW6o7rWq35+2TIkWW9duW7N+oKuM46jiOGGMAaNsW5xzee5xzn8EvRESXZUFEWNcVAFWl73v6vjcGUIAYIyEEANZ1RUSY55lSCo/HA4BhGGiahtvthnOOtm0BSCnRdd1eVAGNMeoR27aptVattbpt22FOjFGrzjsX1I7q/4q3y4xf8i/4FwT3Pcw5Y4zBWvujfQMopZBzJuf8XbCeVyWEgHOO+/2+x0SEaZpIKSEih0X2Wz6jdlxKuezaqL7qpZS0lLKbw/M4ANba3RyapiGE8OJGqOrpizGq916999VATvM/AGFn1sxsVjL5AAAAAElFTkSuQmCC" alt="[toc]"/></script><script type="text/html" class="toc"><header><span>Table of Contents</span><span class="close"><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAYAAAAf8/9hAAAACXBIWXMAABYlAAAWJQFJUiTwAAAAtklEQVQ4jaWT0Q3DIAxEz52AEbyB2cDZhBEY3SNcPyqqBEwqpZaQAHNP5jBCEiJCPAiSIgAeiUe8zoveO9x9e9jd0XtfKwHA1hpHtNY49rO8u59zn4mqMiJSyFkcEVTVFQCAtdYFMotrrXN111JnyA/xCsggN2JeXmGEmaGU8l2XUmBm29fZuh0RW2PTK2SGZcamADPb3nmGmNkKOI7j1rAzJG2kcWhqkstQ1QX+/2ciKU/FJOUN6JFZYWpmK3sAAAAASUVORK5CYII=" alt="X"/></span><p class="ptoc-search"><input class="ptoc-search" placeholder="Search" style="width: 80%"/></p></header><div db-persistent-toc="persistent-toc.html" db-prefix="">Loading…</div></script></nav></body></html>